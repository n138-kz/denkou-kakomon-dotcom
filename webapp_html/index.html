<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>電工過去問.com | n138.jp</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="stylesheet" href="master.css">
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://accounts.google.com/gsi/client" async defer></script>
	<script src="https://www.google.com/recaptcha/api.js?render=6LfCHdcUAAAAAOwkHsW_7W7MfoOrvoIw9CXdLRBA"></script>
	<script src="https://apis.google.com/js/platform.js?key=AIzaSyCNLDeTbvHedVZisnmTamG9qh4wSOjWi1I" async defer></script>
	<meta name="google-signin-client_id" content="784669840257-i0a06p3o6g8k0k1tk26jj09li1q2acud.apps.googleusercontent.com">
	<script async defer>
		function pageInit() {
			document.querySelector('h1#title').innerText = document.title.replace(/ ?\|.*/, '').trim();
		}
		function getCurrentTime() {
			const CURRENT_DATE = new Date();
			let datetime = [{}];
			datetime[0] = {
				hour:   ( '00'   + ( CURRENT_DATE.getHours()    ) ).substr(-2),
				minute: ( '00'   + ( CURRENT_DATE.getMinutes()  ) ).substr(-2),
				second: ( '00'   + ( CURRENT_DATE.getSeconds()  ) ).substr(-2),
				month:  ( '00'   + ( CURRENT_DATE.getMonth()+1  ) ).substr(-2),
				date:   ( '00'   + ( CURRENT_DATE.getDate()     ) ).substr(-2),
				year:   ( '0000' + ( CURRENT_DATE.getFullYear() ) ).substr(-2),
			}
			return datetime;
		}
		function setMenuBarCURRENTDATE(params) {
			params.hour = parseInt(params.hour);
			document.querySelector('#current_datetime').innerHTML  = `${params.hour}:${params.minute}:${params.second}`;
		}
		function onSignIn(googleUser) {
			console.log(googleUser);
		}
		function googleauthInit() {
			let interval = setInterval(()=>{
				let g_id_signin = document.querySelectorAll('.g_id_signin_onload');
				try { Array.from(g_id_signin).map(e=>e.remove()); } catch (error) {}
				g_id_signin = document.createElement('div');
				g_id_signin.classList.add('div_button');
				g_id_signin.classList.add('g_id_signin');
				g_id_signin.classList.add('g_id_signin_onload');
				g_id_signin.dataset.type = 'standard';
				g_id_signin.dataset.shape = 'rectangular';
				g_id_signin.dataset.theme = 'outline';
				g_id_signin.dataset.text = 'signin_with';
				g_id_signin.dataset.size = 'large';
				g_id_signin.dataset.logo_alignment = 'left';
				document.querySelector('#wrap_side').appendChild(g_id_signin);
	
				let g_id_onload = document.querySelector('#g_id_onload');
				try { g_id_onload.remove(); } catch (error) {}
				g_id_onload = document.createElement('div');
				g_id_onload.id = 'g_id_onload';
				g_id_onload.dataset.client_id = '784669840257-i0a06p3o6g8k0k1tk26jj09li1q2acud.apps.googleusercontent.com';
				g_id_onload.dataset.context='signin';
				g_id_onload.dataset.login_uri = location.origin;
				g_id_onload.dataset.login_uri = 'n138-kz.github.io';
				g_id_onload.dataset.callback = 'onSignIn';
				g_id_onload.dataset.ux_mode='popup';
				g_id_onload.dataset.auto_select='true';
				g_id_onload.dataset.itp_support='true';
				document.querySelector('#wrap_side').appendChild(g_id_onload);
				if ( ( document.querySelectorAll('.g_id_signin iframe').length > 0 ) ) {
					clearInterval(interval);
				}
			}, 1000);
		}
		function getMondaiAllCategory() {
			document.querySelector('#selectCategory').innerHTML = '';
			fetch('./getMondaiCategory.json', {
				method: 'get',
			})
			.then(r=>r.json())
			.then(r=>{console.log(r); return r;})
			.then(r=>{
				console.log(r);
				totalCount = 0;
				r.map((e1)=>{
					let obj = [];
					obj[0] = document.createElement('label');
					obj[0].classList.add('focus_pointer')
	
					obj[1] = document.createElement('input');
					obj[1].type = 'checkbox';
					obj[1].name = e1.uuid;
					totalCount += e1.count;
					obj[1].dataset.count = e1.count;
					obj[1].checked = true;
					obj[0].appendChild(obj[1]);
	
					obj[1] = document.createTextNode(`${e1.uuid} ${e1.genre} ${e1.name} (${e1.count})`);
					obj[0].appendChild(obj[1]);
	
					obj[1] = document.createElement('br');
					obj[0].appendChild(obj[1]);
	
					document.querySelector('#selectCategory').appendChild(obj[0]);
				});
	
				initMondaiCount(totalCount);
			})
			.catch(r=>{
				console.error(r);
			})
		}
		function initMondaiCount(totalCount=0) {
			let obj = [];
			obj[0] = document.createElement('div');
			obj[1] = document.createElement('p');
			obj[2] = document.createTextNode('練習問題: ');
			obj[1].appendChild(obj[2]);
			obj[2] = document.createElement('select');
			obj[2].id = 'selectMondaiCount';
			[1,5,10,20,30,40,50,100,150,300].map((e1)=>{
				obj[3] = document.createElement('option');
				obj[3].value = e1;
				obj[3].innerText = e1;
				obj[2].appendChild(obj[3]);
			});
			obj[1].appendChild(obj[2]);
			obj[2] = document.createTextNode('/');
			obj[1].appendChild(obj[2]);
			obj[2] = document.createElement('span');
			obj[2].id = 'selectMondaiTotalCount';
			obj[2].innerText = totalCount;
			obj[1].appendChild(obj[2]);
			obj[2] = document.createTextNode('⇨');
			obj[1].appendChild(obj[2]);
			obj[2] = document.createElement('input');
			obj[2].value = 'Go!';
			obj[2].type = 'button';
			obj[1].appendChild(obj[2]);
			obj[0].appendChild(obj[1]);
			document.querySelector('#selectCategory').after(obj[0]);
		}
	</script>
	<script>
		let element = document.body;
		window.addEventListener('DOMContentLoaded', ()=>{
			element = document.querySelector('#selectCategory');
			element.addEventListener('click', (e1)=>{
				if ( e1.target.tagName.toLowerCase() === 'input' ) {
					let selectCategoryCount = 0;
					Array.from( document.querySelectorAll('#selectCategory input:checked') ).map((e2)=>{
						selectCategoryCount += parseInt(e2.dataset.count);
					});
					document.querySelector('#selectMondaiTotalCount').innerText = selectCategoryCount;
					console.log(selectCategoryCount);
				}
			});
		});
	</script>
	<script>
		window.addEventListener('DOMContentLoaded', ()=>{
			pageInit();
			googleauthInit();
			setTimeout(()=>{
				getMondaiAllCategory();
			}, 500);
			setInterval(() => {
				setMenuBarCURRENTDATE( getCurrentTime()[0] );
			}, 100);
		});
	</script>
	<style>
		#wrap_side {
			float: left;
			width: 150px;
			z-index: 1;
			height: 100%;
			text-align: center;
		}
		#wrap_main {
			margin-left: 150px;
		}
		.focus_pointer {
			cursor: pointer;
			user-select: none;
		}
		#selectCategory {
			border-bottom: #000 solid 1px;
		}
	</style>
</head>
<body>
	<div id="wrap_side">
		<div id="current_datetime"></div>
		<a href="">サインイン</a>
	</div>
	<div id="wrap_main">
		<h1 id="title"></h1>
		<div id="selectCategory"></div>
	</div>
</body>
</html>
